Vagrant.configure("2") do |config|
    config.vm.box = "generic/rocky8"
    config.ssh.insert_key = false
    config.vm.provider "virtualbox" do |vb|
        vb.memory = 512
        vb.linked_clone = true
    end
    # Provision VM
    config.vm.provision "ansible" do |ansible|
        ansible.limit = "all"
        ansible.playbook = "base_provision.yaml"
        ansible.groups = {
            rocky:["rocky1", "rocky2"],
            db:["db"]
        }
    end
    
    # VM config
    (1..2).each do |i|
        config.vm.define "rocky#{i}" do |rocky|
           rocky.vm.hostname = "rocky#{i}"
           rocky.vm.network "private_network", ip: "192.168.56.#{10+i}"
        end
    end

    config.vm.define "db" do |db|
        db.vm.hostname = "db1"
        db.vm.network "private_network", ip: "192.168.56.15"
    end
    
    
end